insert into FDISDISPLANLD
    (DISPLANID,
     ROUTEID,
     SUBROUTEID,
     SEGMENTID,
     BUSID,
     BUSSELFID,
     DRIVERID,
     DRIVERNAME,
     STEWARDID,
     STEWARDNAME,
     SHIFTNUM,
     SHIFTNUMSTRING,
     LEAVETIME,
     ARRIVETIME,
     RECDATE,
     ISSENT,
     WRITETIME,
     WRITEID,
     SEQTYPE,
     MILETYPEID,
     SEGMENTNAME,
     SHIFTTYPE,
     SEQUENCENUM,
     TIMEINTERVAL,
     INFORMTIME,
     REALLEAVETIME,
     REALARRIVETTIME,
     ISINFORMSEND,
     ISFINISHED,
     ISLATE,
     ISSAVE,
     ISSYNC,
     UNEXMCAUSE,
     PREARRIVETTIME,
     MEMOS,
     MILENUM,
     ENDSTATIONID,
     STARTSTATIONID,
     EXTSTEWARDNAME,
     EXTSTEWARDID,
     EXTSTEWARDNAME2,
     EXTSTEWARDID2,
     DISMETHOD,
     ORIGPLANSENDTIME,
     ORIGPLANARRIVETIME,
     SHOWFLAG,
     BUSSID,
     GROUPNUM,
     arrangesid,
     PLANENDSTATIONID,
     PLANSTARTSTATIONID,
     rectype,
     rundate,
     orgid,
     recstate
     -- ,GPSMILE
     -- ROUTENAME,
     --SUBROUTENAME,
     --AHEADLATETIME
     )
    select S_FDISDISPLANGD.Nextval,
           disnowork.routeid,
           disnowork.subrouteid,
           seg.segmentid,
           disnowork.busid,
           disnowork.busselfid,
           disnowork.driverid,
           disnowork.drivername,
           disnowork.stewardid,
           disnowork.stewardname,
           disnowork.shiftnum,
           disnowork.shiftnumstring,
           disnowork.leavetime,
           disnowork.arrivetime,
           disnowork.RECDATE,
           disnowork.ISSENT,
           disnowork.WRITETIME,
           disnowork.WRITEID,
           disnowork.segtype,
           disnowork.MILETYPEID,
           seg.segmentname,
           disnowork.shifttype,
           disnowork.sequencenum,
           disnowork.TIMEINTERVAL,
           disnowork.INFORMTIME,
           disnowork.REALLEAVETIME,
           disnowork.REALARRIVETTIME,
           disnowork.ISINFORMSEND,
           disnowork.ISFINISHED,
           disnowork.ISLATE,
           disnowork.ISSAVE,
           disnowork.ISSYNC,
           disnowork.UNEXMCAUSE,
           disnowork.PREARRIVETTIME,
           disnowork.MEMOS,
           disnowork.MILENUM,
           disnowork.arrivestationid,
           disnowork.leavestationid,
           disnowork.EXTSTEWARDNAME,
           disnowork.EXTSTEWARDID,
           disnowork.EXTSTEWARDNAME2,
           disnowork.EXTSTEWARDID2,
           disnowork.DISMETHOD,
           disnowork.ORIGPLANSENDTIME,
           disnowork.ORIGPLANARRIVETIME,
           disnowork.SHOWFLAG,
           TRIM(disnowork.BUSSID),
           disnowork.groupnum,
           disnowork.arrangesid,
           disnowork.arrivestationid,
           disnowork.leavestationid,
           disnowork.rectype,
           disnowork.execdate,
           disnowork.orgid,
           disnowork.recstate
      from FDISDISPLANNOWORKVIEW disnowork,mcsegmentinfogs seg
     where disnowork.SUBROUTEID=seg.SUBROUTEID and disnowork.isyuan= '0' 
     AND(SEG.RUNDIRECTION= 1   OR SEG.RUNDIRECTION= 3  )
     AND SEG.ISACTIVE= 1   AND disnowork.routeid =320030
     and disnowork.execdate=date'2016-5-27' 
        and disnowork.busid is not null
        and disnowork.milenum is not null
        and disnowork.milenum>0 
        and BUSSID IN (SELECT ITEMVALUE FROM TYPEENTRY WHERE TYPENAME='UNRUNTYPE')
